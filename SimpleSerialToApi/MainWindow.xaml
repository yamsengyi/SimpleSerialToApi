<Window x:Class="SimpleSerialToApi.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:SimpleSerialToApi"
        Title="Simple Serial To API" 
        Height="750" Width="900" 
        MinHeight="700" MinWidth="850"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
        <local:BoolToColorConverter x:Key="BoolToColorConverter"/>
    </Window.Resources>
    
    <DockPanel>
        <!-- ë©”ë‰´ ë°” -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="ì„¤ì •">
                <MenuItem Name="MenuStartupRegister" Header="ìœˆë„ìš° ì‹œìž‘ í”„ë¡œê·¸ëž¨ ë“±ë¡" Click="StartupRegister_Click"/>
                <MenuItem Name="MenuStartupUnregister" Header="ìœˆë„ìš° ì‹œìž‘ í”„ë¡œê·¸ëž¨ ì‚­ì œ" Click="StartupUnregister_Click"/>
                <Separator/>
                <MenuItem Header="íŠ¸ë ˆì´ ì„¤ì •" Click="TraySettings_Click"/>
                <Separator/>
                <MenuItem Header="ì¢…ë£Œ" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="ë„êµ¬">
                <MenuItem Header="ì‹œìž‘ í”„ë¡œê·¸ëž¨ ìƒíƒœ í™•ì¸" Click="CheckStartupStatus_Click"/>
                <MenuItem Header="ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì—´ê¸°" Click="OpenRegistry_Click"/>
            </MenuItem>
            <MenuItem Header="ë„ì›€ë§">
                <MenuItem Header="ì •ë³´" Click="About_Click"/>
            </MenuItem>
        </Menu>
        
        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

        <!-- Serial Port Configuration -->
        <GroupBox Grid.Row="0" Header="Serial Port" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Label Grid.Column="0" Content="Port:" VerticalAlignment="Center"/>
                <ComboBox Grid.Column="1" 
                          ItemsSource="{Binding AvailablePorts}" 
                          SelectedValue="{Binding SerialPort}" 
                          SelectedValuePath="PortName"
                          DisplayMemberPath="DisplayName"
                          Margin="5,0" 
                          VerticalAlignment="Center"
                          MinWidth="200"/>
                <Button Grid.Column="2" 
                        Content="ðŸ”„" 
                        Command="{Binding RefreshPortsCommand}" 
                        Margin="5,0" 
                        Padding="8,5"
                        ToolTip="í¬íŠ¸ ëª©ë¡ ìƒˆë¡œê³ ì¹¨"
                        FontSize="14"/>
                <Button Grid.Column="3" 
                        Content="í†µì‹ ì„¤ì •" 
                        Command="{Binding OpenSerialConfigCommand}" 
                        Margin="5,0" 
                        Padding="10,5"
                        ToolTip="í†µì‹  íŒŒë¼ë¯¸í„° ì„¤ì • (Baudrate, Parity, Data bits ë“±)"/>
                <Button Grid.Column="4" Content="Connect" Command="{Binding ConnectCommand}" Margin="5,0" Padding="10,5"/>
                <Button Grid.Column="5" Content="Disconnect" Command="{Binding DisconnectCommand}" Margin="5,0" Padding="10,5"/>
            </Grid>
        </GroupBox>

        <!-- API Configuration -->
        <GroupBox Grid.Row="1" Header="API Settings" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Label Grid.Column="0" Content="API URL:" VerticalAlignment="Center"/>
                <TextBox Grid.Column="1" Text="{Binding ApiUrl}" Margin="5,0" VerticalAlignment="Center"/>
                <Button Grid.Column="2" Content="Test" Command="{Binding TestApiCommand}" Margin="5,0" Padding="10,5"/>
            </Grid>
        </GroupBox>

        <!-- Status -->
        <GroupBox Grid.Row="2" Header="Status" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <Label Grid.Column="0" Content="Status:" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Text="{Binding Status}" Margin="5,0" VerticalAlignment="Center"/>
            </Grid>
        </GroupBox>

        <!-- Device Identification -->
        <GroupBox Grid.Row="3" Header="Device Identification" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Label Grid.Column="0" Content="Device ID:" VerticalAlignment="Center"/>
                <TextBox Grid.Column="1" Name="TxtDeviceId" Text="{Binding DeviceId, UpdateSourceTrigger=PropertyChanged}" 
                         Margin="5,0" VerticalAlignment="Center" Padding="5,2"
                         ToolTip="ìž¥ë¹„ë¥¼ ì‹ë³„í•  ìˆ˜ ìžˆëŠ” ê³ ìœ  IDë¥¼ ìž…ë ¥í•˜ì„¸ìš”"/>
                <Button Grid.Column="2" Content="ì„¤ì •" Command="{Binding SetDeviceIdCommand}" 
                        Margin="5,0" Padding="10,5"
                        ToolTip="Device IDë¥¼ ì €ìž¥í•©ë‹ˆë‹¤"/>
            </Grid>
        </GroupBox>

        <!-- Data Mapping Configuration (Button Only) -->
        <GroupBox Grid.Row="5" Header="Data Mapping and API Configuration" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Button Content="ë°ì´í„° ë§¤í•‘ ë° API ì„¤ì •" Command="{Binding OpenDataMappingCommand}" 
                        Padding="15,8" MinWidth="200" Background="LightBlue"
                        ToolTip="ë°ì´í„° ë§¤í•‘ ì‹œë‚˜ë¦¬ì˜¤ ë° API ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤"/>
                <TextBlock Text="{Binding MappingScenariosCount, StringFormat='í™œì„± ì‹œë‚˜ë¦¬ì˜¤: {0}ê°œ'}" 
                           VerticalAlignment="Center" Margin="20,0,0,0" Foreground="Gray" FontSize="12"/>
            </StackPanel>
        </GroupBox>

        <!-- Queue Management -->
        <GroupBox Grid.Row="6" Header="Queue Management" Margin="0,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- ì²« ë²ˆì§¸ í–‰: ì „ì†¡ ê°„ê²© ì„¤ì • -->
                <Grid Grid.Row="0" Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <Label Grid.Column="0" Content="ì „ì†¡ê°„ê²©(ì´ˆ):" VerticalAlignment="Center"/>
                    <TextBox Grid.Column="1" Name="TxtTransmissionInterval" Text="{Binding TransmissionInterval, UpdateSourceTrigger=PropertyChanged}" 
                             VerticalAlignment="Center" Margin="5,0" Padding="5,2"/>
                    <Button Grid.Column="2" Content="ì„¤ì •" Command="{Binding SetTransmissionIntervalCommand}" 
                            Margin="5,0" Padding="10,2"/>
                    
                    <Label Grid.Column="3" Content="ë™ì‹œì „ì†¡ëŸ‰:" VerticalAlignment="Center" Margin="15,0,0,0"/>
                    <TextBox Grid.Column="4" Name="TxtBatchSize" Text="{Binding BatchSize, UpdateSourceTrigger=PropertyChanged}" 
                             VerticalAlignment="Center" Margin="5,0" Padding="5,2"/>
                    <Button Grid.Column="5" Content="ì„¤ì •" Command="{Binding SetBatchSizeCommand}" 
                            Margin="5,0" Padding="10,2"/>
                    
                    <Label Grid.Column="7" Content="í˜„ìž¬ Queue:" VerticalAlignment="Center" Margin="15,0,0,0"/>
                    <TextBlock Grid.Column="8" Text="{Binding QueueCount}" Margin="5,0" VerticalAlignment="Center" 
                               FontWeight="Bold" FontSize="14"/>
                </Grid>
            </Grid>
        </GroupBox>

        <!-- Simulation Controls -->
        <GroupBox Grid.Row="7" Header="Simulation (Testing without hardware)" Margin="0,0,0,10">
            <StackPanel>
                <Grid Margin="0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <Label Grid.Column="0" Content="ê°„ê²©(ì´ˆ):" VerticalAlignment="Center"/>
                    <TextBox Grid.Column="1" Text="{Binding SimulationInterval, UpdateSourceTrigger=PropertyChanged}" 
                             VerticalAlignment="Center" Margin="5,0" Padding="5,2"/>
                    <Button Grid.Column="2" Content="{Binding SimulationButtonText}" Command="{Binding StartSimulationCommand}" 
                            Margin="10,0,5,0" Padding="15,5" MinWidth="120"
                            Background="{Binding IsSimulating, Converter={StaticResource BoolToColorConverter}}"
                            ToolTip="ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œìž‘/ì¤‘ì§€í•©ë‹ˆë‹¤"/>
                    <Button Grid.Column="3" Content="ë‹¨ì¼ ë°ì´í„° ìƒì„±" Command="{Binding GenerateSingleDataCommand}" 
                            Margin="5,0" Padding="10,5" ToolTip="í•œ ë²ˆë§Œ ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤"/>
                    <TextBlock Grid.Column="5" Text="ì‹œë®¬ë ˆì´ì…˜ì€ ì‹¤ì œ ìž¥ë¹„ ì—†ì´ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìžˆë„ë¡ ê°€ìƒ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤" 
                               VerticalAlignment="Center" Margin="20,0,0,0" FontStyle="Italic" FontSize="11" Foreground="Gray"/>
                </Grid>
            </StackPanel>
        </GroupBox>
        
        <!-- Monitor Controls -->
        <GroupBox Grid.Row="8" Header="Monitoring" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Button Content="Serial Monitor ì—´ê¸°" Command="{Binding OpenSerialMonitorCommand}" 
                        Margin="0,0,15,0" Padding="15,8" MinWidth="180" Background="LightGreen"
                        ToolTip="ì‹œë¦¬ì–¼ í†µì‹  ëª¨ë‹ˆí„° ì°½ì„ ì—½ë‹ˆë‹¤"/>
                <Button Content="API Monitor ì—´ê¸°" Command="{Binding OpenApiMonitorCommand}" 
                        Margin="0,0,15,0" Padding="15,8" MinWidth="180" Background="LightCoral"
                        ToolTip="API í†µì‹  ëª¨ë‹ˆí„° ì°½ì„ ì—½ë‹ˆë‹¤"/>
                <Button Content="ðŸ—‘ï¸ Queue í´ë¦¬ì–´" Command="{Binding ClearQueueCommand}" 
                        Margin="0,0,15,0" Padding="15,8" MinWidth="140" Background="Orange"
                        ToolTip="ë©”ì‹œì§€ íë¥¼ ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤"/>
                <Button Content="ðŸ“‹ ë¡œê·¸ í´ë¦¬ì–´" Command="{Binding ClearLogsCommand}" 
                        Margin="0,0,15,0" Padding="15,8" MinWidth="140" Background="LightYellow"
                        ToolTip="ëª¨ë“  ëª¨ë‹ˆí„° ë¡œê·¸ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤"/>
                <TextBlock Text="{Binding SerialMonitorStatus}" VerticalAlignment="Center" 
                           Margin="20,0,10,0" Foreground="Gray" FontSize="11"/>
                <TextBlock Text="{Binding ApiMonitorStatus}" VerticalAlignment="Center" 
                           Foreground="Gray" FontSize="11"/>
            </StackPanel>
        </GroupBox>

        <!-- Footer -->
        <TextBlock Grid.Row="9" Text="Simple Serial To API - Ready" HorizontalAlignment="Center" 
                   Foreground="Gray" FontSize="10" Margin="0,10,0,0"/>
        </Grid>
    </DockPanel>
</Window>
