<Window x:Class="SimpleSerialToApi.Views.SerialConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:system="clr-namespace:System;assembly=System.Runtime"
        xmlns:ports="clr-namespace:System.IO.Ports;assembly=System.IO.Ports"
        Title="시리얼 통신 설정" 
        SizeToContent="WidthAndHeight"
        MinWidth="450" MinHeight="400"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        ShowInTaskbar="False">
    
    <Window.Resources>
        <ObjectDataProvider x:Key="ParityEnum" MethodName="GetValues" ObjectType="{x:Type system:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="ports:Parity"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <ObjectDataProvider x:Key="StopBitsEnum" MethodName="GetValues" ObjectType="{x:Type system:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="ports:StopBits"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <ObjectDataProvider x:Key="HandshakeEnum" MethodName="GetValues" ObjectType="{x:Type system:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="ports:Handshake"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" Text="시리얼 통신 파라미터 설정" 
                   FontSize="16" FontWeight="Bold" 
                   HorizontalAlignment="Center" Margin="0,0,0,20"/>
        
        <!-- Baud Rate -->
        <Grid Grid.Row="1" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Column="0" Content="Baud Rate:" VerticalAlignment="Center"/>
            <ComboBox Grid.Column="1" Name="ComboBaudRate" SelectedValue="{Binding BaudRate}" 
                      VerticalAlignment="Center" Padding="5">
                <ComboBox.Items>
                    <system:Int32>1200</system:Int32>
                    <system:Int32>2400</system:Int32>
                    <system:Int32>4800</system:Int32>
                    <system:Int32>9600</system:Int32>
                    <system:Int32>14400</system:Int32>
                    <system:Int32>19200</system:Int32>
                    <system:Int32>38400</system:Int32>
                    <system:Int32>57600</system:Int32>
                    <system:Int32>115200</system:Int32>
                    <system:Int32>230400</system:Int32>
                    <system:Int32>460800</system:Int32>
                    <system:Int32>921600</system:Int32>
                </ComboBox.Items>
            </ComboBox>
        </Grid>
        
        <!-- Parity -->
        <Grid Grid.Row="2" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Column="0" Content="Parity:" VerticalAlignment="Center"/>
            <ComboBox Grid.Column="1" Name="ComboParity" 
                      ItemsSource="{Binding Source={StaticResource ParityEnum}}"
                      SelectedItem="{Binding Parity}" 
                      VerticalAlignment="Center" Padding="5"/>
        </Grid>
        
        <!-- Data Bits -->
        <Grid Grid.Row="3" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Column="0" Content="Data Bits:" VerticalAlignment="Center"/>
            <ComboBox Grid.Column="1" Name="ComboDataBits" SelectedValue="{Binding DataBits}" 
                      VerticalAlignment="Center" Padding="5">
                <ComboBox.Items>
                    <system:Int32>5</system:Int32>
                    <system:Int32>6</system:Int32>
                    <system:Int32>7</system:Int32>
                    <system:Int32>8</system:Int32>
                </ComboBox.Items>
            </ComboBox>
        </Grid>
        
        <!-- Stop Bits -->
        <Grid Grid.Row="4" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Column="0" Content="Stop Bits:" VerticalAlignment="Center"/>
            <ComboBox Grid.Column="1" Name="ComboStopBits" 
                      ItemsSource="{Binding Source={StaticResource StopBitsEnum}}"
                      SelectedItem="{Binding StopBits}" 
                      VerticalAlignment="Center" Padding="5"/>
        </Grid>
        
        <!-- Handshake -->
        <Grid Grid.Row="5" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Column="0" Content="Handshake:" VerticalAlignment="Center"/>
            <ComboBox Grid.Column="1" Name="ComboHandshake" 
                      ItemsSource="{Binding Source={StaticResource HandshakeEnum}}"
                      SelectedItem="{Binding Handshake}" 
                      VerticalAlignment="Center" Padding="5"/>
        </Grid>
        
        <!-- Timeouts -->
        <Grid Grid.Row="6" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="60"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Column="0" Content="Timeout (ms):" VerticalAlignment="Center"/>
            <TextBox Grid.Column="1" Text="{Binding ReadTimeout}" VerticalAlignment="Center" Padding="5"/>
            <Label Grid.Column="2" Content="/" VerticalAlignment="Center" HorizontalAlignment="Center"/>
            <Label Grid.Column="3" Content="Write:" VerticalAlignment="Center"/>
            <TextBox Grid.Column="4" Text="{Binding WriteTimeout}" VerticalAlignment="Center" Padding="5"/>
        </Grid>
        
        <!-- Current Settings Display -->
        <GroupBox Grid.Row="7" Header="현재 설정" Margin="0,10,0,15">
            <StackPanel>
                <TextBlock Text="{Binding SettingsDescription}" 
                           TextWrapping="Wrap" 
                           Margin="5" 
                           FontFamily="Consolas" 
                           FontSize="11" 
                           Background="LightGray" 
                           Padding="8"/>
            </StackPanel>
        </GroupBox>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="9" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="기본값 복원" Name="BtnDefault" Click="BtnDefault_Click" 
                    Margin="0,0,10,0" Padding="15,8" MinWidth="100"/>
            <Button Content="테스트" Name="BtnTest" Click="BtnTest_Click" 
                    Margin="0,0,10,0" Padding="15,8" MinWidth="80"/>
            <Button Content="확인" Name="BtnOK" Click="BtnOK_Click" 
                    Margin="0,0,10,0" Padding="15,8" MinWidth="80" IsDefault="True"/>
            <Button Content="취소" Name="BtnCancel" Click="BtnCancel_Click" 
                    Padding="15,8" MinWidth="80" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
